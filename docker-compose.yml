services:
  postgres:
    image: postgres:16
    environment:
      POSTGRES_DB: authshield
      POSTGRES_USER: authshield
      POSTGRES_PASSWORD: authshield
    ports:
    - 5432:5432
    volumes:
    - authshield_pg:/var/lib/postgresql/data
  server:
    build:
      context: ./server
    environment:
      PORT: 8080
      DATABASE_URL: jdbc:postgresql://postgres:5432/authshield
      DB_USER: authshield
      DB_PASSWORD: authshield
    ports:
    - 8080:8080
    depends_on:
    - postgres
  client:
    build:
      context: ./client
      dockerfile: Dockerfile
    environment:
      VITE_API_TARGET: http://server:8080
      VITE_WS_TARGET: ws://server:8080
    ports:
    - 5173:5173
    depends_on:
    - server
    volumes:
      - ./client/certs:/app/client/certs:ro
volumes:
  authshield_pg: null
